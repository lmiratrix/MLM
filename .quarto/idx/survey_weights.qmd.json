{"title":"Survey Weights","markdown":{"yaml":{"title":"Survey Weights","author":"Luke Miratrix","editor":{"markdown":{"wrap":"sentence"}}},"headingText":"Multilevel modeling and survey weights","containsRefs":false,"markdown":"\n\n\nIn many circumstances you may be faced with a multilevel modeling project where you also have survey weights.\nUnfortunately R does not have good support for this hybrid of two worlds (although if you go the econometric direction you can incorporate weights into your robust standard errors).\n\nYou basically have two options at this point: you can ignore the weights (defendable, but often upsetting to reviewers and colleagues), or switch to Stata, which allows for both.\n\n## Topline advice\n\nIgnore the weights for your final project and worry about extending to your general population later on, depending on where your research takes you.\nMore important than the weights is making sure you have random effects corresponding to all clustering involved in the way the data were collected.\nFor example, if the program was a sample of states and then a sample of villages, and then households, you would have a 4-level model: states, villages, households, and individuals.\nYou would want a random effect for each level.\nIf you had few states, you could back off and have fixed effects for state and generalize only to the sampled states rather than the full country.\n\n## What are survey weights?\n\nThe easy way to think of sample weights (survey weights) is the answer to \"how many people does this individual represent in the population?\" (Although note that weights will generally be proportional to the answer to this question rather than literally that value.)\n\nFor example, if you had three people, the first with a weight of 1, the second with a weight of 0.5 and the third with a weight of 3, then we would think of our population as being $1 + 0.5 + 3 = 4.5$ people, 3 of whom are people similar to our third sampled person, 0.5 of which our second sampled person, and 1 of whom is similar to our first person.\n\nIn other words, our first person is sampled proportional to their prevalence in the population.\nThe 0.5 weight person is \"oversampled\"---we have too many people like this in our sample, as compared to the population so we \"downweight\" them.\nThe third person is underrepresented, by contrast.\nWe should have had three times as many of these types of people in our sample as we have.\n\nThus, sampling weights adjust for the probability of selecting an individual from the population when that probability is not constant (this could be due either by design or by chance).\nFor nationally representative data surveys often select a sample where individuals have an unequal probability of being selected.\nThis is done to increase the number of individuals and reduce sampling variability, particularly for certain areas or subgroups of the population.\nIn some cases, corrections for non-response are also built into the weights.\nSampling weights are then inversely proportional to the probability of selection.\n\nIn some complex surveys, there may be more than one sampling weight when different subsamples are selected.\nFor example, the Demographic and Health Surveys (DHS)[^survey_weights-1] select a subsample of adults to be tested for HIV.\nIf 1 in 5 households is selected for HIV testing, then no weighting is needed.\nBut if 1 in 5 urban households and 1 in 2 rural households are selected, then sampling weights need to be applied to both descriptive statistics and model estimates to estimate at national level.\n\n[^survey_weights-1]: These are nationally representative surveys conducted in low- and middle-income countries collecting data primarily on maternal and child health.\n\n## What happens if you ignore the weights?\n\nIn this case (as long as you are modeling the clustering correctly) you are estimating relationships on your sample, rather than the target population.\nThis can be a totally fine thing: if you are interested in how some variables interrelate you might reasonably believe that a found pattern of relationships in the sample is very indicative of how things may play out on a wider stage.\nIt would be odd for (statistically significant) relationships in the sample to not be at least somewhat similar to the population the sample came from.\nThe true magnitudes may shift, but the story should be the same.\n\nFor example, if, after ignoring weights, you find an impact of some treatment, then you know the treatment works, at least for those in your sample.\nEven if your sample is a nonrepresentative sample of your population, it is still some sort of representation, and thus you would believe that your treatment would work to some degree more generally.\nIn this case, any differences between your sample and population would be due to treatment variation, i.e., some in your sample respond differently than some in the population, and so your results in the sample would be weighting some people more than we \"should,\" causing the discrepancy.\n\nSurvey weights are usually much more important when trying to estimate level, or prevalence, of an outcome.\nIf, for example, you are attempting to measure the average literacy in a population, then survey weights will be very important: if the weights of those systematically more (or less) literate are different, then ignoring the weights can cause bias.\nIn addition, if some types of groups or areas are oversampled, then your estimates will tend to be biased towards the levels and relationships in the oversampled group/area.\nBut if you are interested in the relationship between literacy and some covariate, the weights will matter less: it is only if the relationship between these variables is different in your high weight and low weight individuals where you will get bias.\nThis is arguably a less natural phenomenon.\n\n## How to apply weights?\n\nAs a rule of thumb, you want to first read any available documentation for the data you are using.\nYou want to understand how the sample was obtained and how the weights were calculated.\nPublicly available data often comes with manuals on how to handle weights.\nSome manuals even come with R and Stata code!\nThis is a very important step as sometimes you have to manipulate the weights before you can use them!\nFor example, when using DHS data, you have to divide the weight by 1,000,000 before use.\nThis is a function of how the weights are calculated.\nIn addition, many complex surveys that use weights may also have stratified the sample, and that is also something to account for in your analysis.\n\nWhen using survey weights it is always advisable to compare the results that include weights with those without them.\nIn general, one should not expect see substantive changes in the point estimates of regression coefficients to the point of dramatically changing one's interpretation of one's results.\nThe model itself is supposed to capture structural relationships between covariates and outcomes, and under correct model specification the weights are superfluous with regards to these coefficients.\nWhere weights could cause change is with descriptives such as the overall averages (e.g., the intercepts, in particular, could be different. We may also see changes in the variance parameters. Finally, with weights, one usually sees an increase in the the standard errors.\n\nA limitation with some packages is one might not have an easy way to obtain model fit statistics to help compare models.\nA clean way to avoid this is to go through the process of model selection using the data in the sample (ignoring the weights) and using the packages and approaches we have seen in class.\nThe findings from such an exploration would be valid for the structure of the data in our sample.\nThen, as a second step, include the survey weights to move to inference to a larger population (for which the sample is supposed to be representative), taking the preferred model choices from step one and fitting them through a package that allows for survey weights.\n\n## Further references\n\nFor some good resources see [@asparouhov2006; @carle2009; @rabe-hesketh2006].\nPrior students previously also used @laukaityte2018importance and @lorah2020estimating for some guidance.\nThey then worked with the `BIFIEsurvey` R package to fit multi-level models with survey weights to account for the complex sampling design in their data.\n","srcMarkdownNoYaml":"\n\n## Multilevel modeling and survey weights\n\nIn many circumstances you may be faced with a multilevel modeling project where you also have survey weights.\nUnfortunately R does not have good support for this hybrid of two worlds (although if you go the econometric direction you can incorporate weights into your robust standard errors).\n\nYou basically have two options at this point: you can ignore the weights (defendable, but often upsetting to reviewers and colleagues), or switch to Stata, which allows for both.\n\n## Topline advice\n\nIgnore the weights for your final project and worry about extending to your general population later on, depending on where your research takes you.\nMore important than the weights is making sure you have random effects corresponding to all clustering involved in the way the data were collected.\nFor example, if the program was a sample of states and then a sample of villages, and then households, you would have a 4-level model: states, villages, households, and individuals.\nYou would want a random effect for each level.\nIf you had few states, you could back off and have fixed effects for state and generalize only to the sampled states rather than the full country.\n\n## What are survey weights?\n\nThe easy way to think of sample weights (survey weights) is the answer to \"how many people does this individual represent in the population?\" (Although note that weights will generally be proportional to the answer to this question rather than literally that value.)\n\nFor example, if you had three people, the first with a weight of 1, the second with a weight of 0.5 and the third with a weight of 3, then we would think of our population as being $1 + 0.5 + 3 = 4.5$ people, 3 of whom are people similar to our third sampled person, 0.5 of which our second sampled person, and 1 of whom is similar to our first person.\n\nIn other words, our first person is sampled proportional to their prevalence in the population.\nThe 0.5 weight person is \"oversampled\"---we have too many people like this in our sample, as compared to the population so we \"downweight\" them.\nThe third person is underrepresented, by contrast.\nWe should have had three times as many of these types of people in our sample as we have.\n\nThus, sampling weights adjust for the probability of selecting an individual from the population when that probability is not constant (this could be due either by design or by chance).\nFor nationally representative data surveys often select a sample where individuals have an unequal probability of being selected.\nThis is done to increase the number of individuals and reduce sampling variability, particularly for certain areas or subgroups of the population.\nIn some cases, corrections for non-response are also built into the weights.\nSampling weights are then inversely proportional to the probability of selection.\n\nIn some complex surveys, there may be more than one sampling weight when different subsamples are selected.\nFor example, the Demographic and Health Surveys (DHS)[^survey_weights-1] select a subsample of adults to be tested for HIV.\nIf 1 in 5 households is selected for HIV testing, then no weighting is needed.\nBut if 1 in 5 urban households and 1 in 2 rural households are selected, then sampling weights need to be applied to both descriptive statistics and model estimates to estimate at national level.\n\n[^survey_weights-1]: These are nationally representative surveys conducted in low- and middle-income countries collecting data primarily on maternal and child health.\n\n## What happens if you ignore the weights?\n\nIn this case (as long as you are modeling the clustering correctly) you are estimating relationships on your sample, rather than the target population.\nThis can be a totally fine thing: if you are interested in how some variables interrelate you might reasonably believe that a found pattern of relationships in the sample is very indicative of how things may play out on a wider stage.\nIt would be odd for (statistically significant) relationships in the sample to not be at least somewhat similar to the population the sample came from.\nThe true magnitudes may shift, but the story should be the same.\n\nFor example, if, after ignoring weights, you find an impact of some treatment, then you know the treatment works, at least for those in your sample.\nEven if your sample is a nonrepresentative sample of your population, it is still some sort of representation, and thus you would believe that your treatment would work to some degree more generally.\nIn this case, any differences between your sample and population would be due to treatment variation, i.e., some in your sample respond differently than some in the population, and so your results in the sample would be weighting some people more than we \"should,\" causing the discrepancy.\n\nSurvey weights are usually much more important when trying to estimate level, or prevalence, of an outcome.\nIf, for example, you are attempting to measure the average literacy in a population, then survey weights will be very important: if the weights of those systematically more (or less) literate are different, then ignoring the weights can cause bias.\nIn addition, if some types of groups or areas are oversampled, then your estimates will tend to be biased towards the levels and relationships in the oversampled group/area.\nBut if you are interested in the relationship between literacy and some covariate, the weights will matter less: it is only if the relationship between these variables is different in your high weight and low weight individuals where you will get bias.\nThis is arguably a less natural phenomenon.\n\n## How to apply weights?\n\nAs a rule of thumb, you want to first read any available documentation for the data you are using.\nYou want to understand how the sample was obtained and how the weights were calculated.\nPublicly available data often comes with manuals on how to handle weights.\nSome manuals even come with R and Stata code!\nThis is a very important step as sometimes you have to manipulate the weights before you can use them!\nFor example, when using DHS data, you have to divide the weight by 1,000,000 before use.\nThis is a function of how the weights are calculated.\nIn addition, many complex surveys that use weights may also have stratified the sample, and that is also something to account for in your analysis.\n\nWhen using survey weights it is always advisable to compare the results that include weights with those without them.\nIn general, one should not expect see substantive changes in the point estimates of regression coefficients to the point of dramatically changing one's interpretation of one's results.\nThe model itself is supposed to capture structural relationships between covariates and outcomes, and under correct model specification the weights are superfluous with regards to these coefficients.\nWhere weights could cause change is with descriptives such as the overall averages (e.g., the intercepts, in particular, could be different. We may also see changes in the variance parameters. Finally, with weights, one usually sees an increase in the the standard errors.\n\nA limitation with some packages is one might not have an easy way to obtain model fit statistics to help compare models.\nA clean way to avoid this is to go through the process of model selection using the data in the sample (ignoring the weights) and using the packages and approaches we have seen in class.\nThe findings from such an exploration would be valid for the structure of the data in our sample.\nThen, as a second step, include the survey weights to move to inference to a larger population (for which the sample is supposed to be representative), taking the preferred model choices from step one and fitting them through a package that allows for survey weights.\n\n## Further references\n\nFor some good resources see [@asparouhov2006; @carle2009; @rabe-hesketh2006].\nPrior students previously also used @laukaityte2018importance and @lorah2020estimating for some guidance.\nThey then worked with the `BIFIEsurvey` R package to fit multi-level models with survey weights to account for the complex sampling design in their data.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"pygments","output-file":"survey_weights.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","bibliography":["references.bib"],"output_dir":"docs","editor":{"markdown":{"wrap":"sentence"}},"theme":"cosmo","code-copy":true,"title":"Survey Weights","author":"Luke Miratrix"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","highlight-style":"pygments","output-file":"survey_weights.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"output_dir":"docs","editor":{"markdown":{"wrap":"sentence"}},"documentclass":"scrreprt","title":"Survey Weights","author":"Luke Miratrix"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}