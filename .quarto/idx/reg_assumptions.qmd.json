{"title":"MLM Assumptions","markdown":{"yaml":{"title":"MLM Assumptions","author":"Luke Miratrix","editor":{"markdown":{"wrap":"sentence"}}},"headingText":"Oh, assumptions","containsRefs":false,"markdown":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n\n\nlibrary( tidyverse )\nlibrary( arm )\nlibrary(sjPlot)\n\nset.seed( 101020 )\n```\n\n\nThere are generally two kinds of assumptions we should worry about the most: ommitted variable bias, and independence assumptions.\nThe latter of these is one we should always think about.\n\nDo read Chapter 9 of R&B, paying attention to their examples and not so much to the mathematical formalism.\nIt has some dense prose, but then moves to specific diagnostics that make what they are talking about much more clear (and it also provides things you can do to check assumptions).\nThe *MLM in Plain Language* text has some simpler explanations.\nAlso see below for some further notes.\n\n## Ommitted variable bias\n\nConsider the following numerical example:\n\n```{r}\nN = 100\ndat = data.frame( X1 = rnorm( N ) )\ndat = mutate( dat, \n              X2 = X1 + rnorm( N ),\n              Y = 3 + 0.5 * X1 + 1.5 * X2 + rnorm( N ) )\n```\n\nThe above makes an `X2` that is correlated with `X1`, and a `Y` that is a function of both.\nThe true model here is $$ Y_i = \\beta_0 + \\beta_1 X_{1i} + \\beta_2 X_{2i} + \\epsilon_{i} $$ with coefficents $\\beta = (3, 0.5, 1.5)$.\n\nWe fit two models, one with both covariates, and one with only one:\n\n```{r}\nM0 = lm( Y ~ 1 + X1 + X2 , data = dat )\nM1 = lm( Y ~ 1 + X1, data = dat )\n```\n\nOur results:\n\n```{r}\ntab_model(M0, M1, p.style = \"stars\",\n          show.ci = FALSE, show.se = TRUE)\n```\n\nNote our coefficient is completely wrong when we omit a correlated variable.\nThis is omitted variable bias, and in terms of our assumptions we are in a circumstance where the true residuals in our model are not centered around 0 for all values of `X1`, since they include the `X2` effect which is correlated with `X1`.\nWe can see this as follows:\n\n```{r, fig.height=3, fig.width=3}\ndat = mutate( dat, e = Y - 3 - 0.5 * X1 )\nggplot( dat, aes( X1, e ) ) +\n    geom_point() +\n    geom_hline( yintercept = 0 )\n```\n\nNote how our residuals (which includes `X2`) are positive for bigger `X1`, due to the correlation of `X1` and `X2`.\n\n*Conclusion:* On one hand, we have the wrong estimate for $\\beta_1$.\nOn the other, the estimate we do get is fine if we view it as the best description of the data.\nWe just need to remember that the interpretation of our coefficient includes the confounding effect of `X2` on `X1`.\n\nIn this vein:\n\nQ: You mentioned during class that we don't care too much about assumptions when looking at trends in the data.\nHowever, if we are trying to draw causal inferences, do these assumptions become more important?\n\nA: Even with the assumptions causal inference would depend on the model.\nModern causal inference has a hard time with this, so you need other strategies such as quasiexperimental design.\nHence my focus on descriptive aspects of data analysis.\n\n## Independence assumptions\n\nThe independence assumptions are key.\nWhen we do not take violations of independence into account, we can be overly confident of our estimates.\n\nGenerally with MLM we should think of these assumptions in terms of how we sampled our data.\nIf we sampled our data by sampling a collection of schools, and then individuals within those schools, then we have two levels.\nWe then need to ask two questions:\n\n(1) Were the schools sampled independently?\n\n(2) Were the students sampled independently within the schools?\n\nIf yes to both, we have met both our independence assumptions!\nWe have met them even if the students are clustered in classes within their schools.\nAs long as we did not sample using those classes (or other clusters), we are ok as our sample of students will be representative of the school they are in.\n\nOne might then ask, more generally, if there is a problem with clustering if it's not part of the sampling plan?\nE.g. if you sampled at the school level and surveyed all students, there is still natural clustering in classrooms: is that a problem?\nWhat about unobserved clustering like families, neighborhoods, etc. which are not part of sampling, but do exist naturally in populations?\n\nE.g., see this [document](https://blogs.worldbank.org/impactevaluations/when-should-you-cluster-standard-errors-new-wisdom-econometrics-oracle) which says clustered SEs are *not* necessary (in OLS) unless sampling was conducted at the cluster-level and that econometricians often overuse them.\n\nThis is indeed correct.\nThat being said, we might want to make clusters to investigate how things vary across those clusters.\n\nQ: More generally, is there a problem with clustering if it's not part of the sampling plan?\nE.g. if you sampled at the school level and surveyed all students, there is still natural clustering in classrooms: is that a problem?\nWhat about unobserved clustering like families, neighborhoods, etc. which are not part of sampling, but do exist naturally in populations?\nQ: I'll let Luke respond to how this affects the assumptions later on Piazza.\nMy intuition is that we want to cluster/add levels at these different levels if we believe the outcomes or predictors are correlated Q: Thanks.\nI remember reading this https://blogs.worldbank.org/impactevaluations/when-should-you-cluster-standard-errors-new-wisdom-econometrics-oracle a few years ago, which says clustered SEs are *not* necessary (in OLS) unless sampling was conducted at the cluster-level and that econometricians often overuse them, but I am wondering to what degree this holds in MLMs.\n\nA: This is correct.\nThat being said, we might want to make clusters to investigate how things vary across those clusters.\n\n## Number of clusters needed?\n\nOk, this isn't an assumption per se, but onwards!\n\nQ: Why should you worry if the number of group is small?\n(referencing the recap slide)\n\nA: With few clusters, estimation is hard just like having a small dataset with OLS.\nThe variance parameters in particular are difficult.\n\nQ: When you say \"at least 20\" you mean for the number of j's, right?\n\nA: Yes, number of clusters.\nMostly Harmless Econometrics readers might recall a discussion of 42 clusters (8.2.3), which contributes to this debate of the appropriate level of j-units\n\n## Testing assumptions\n\nQ: How do we test these assumptions?\n\nA: Often with plots, like with classic OLS.\nfor example we can pot a histogram of the residuals and see if they are normally distributed.\n","srcMarkdownNoYaml":"\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n\n\nlibrary( tidyverse )\nlibrary( arm )\nlibrary(sjPlot)\n\nset.seed( 101020 )\n```\n\n## Oh, assumptions\n\nThere are generally two kinds of assumptions we should worry about the most: ommitted variable bias, and independence assumptions.\nThe latter of these is one we should always think about.\n\nDo read Chapter 9 of R&B, paying attention to their examples and not so much to the mathematical formalism.\nIt has some dense prose, but then moves to specific diagnostics that make what they are talking about much more clear (and it also provides things you can do to check assumptions).\nThe *MLM in Plain Language* text has some simpler explanations.\nAlso see below for some further notes.\n\n## Ommitted variable bias\n\nConsider the following numerical example:\n\n```{r}\nN = 100\ndat = data.frame( X1 = rnorm( N ) )\ndat = mutate( dat, \n              X2 = X1 + rnorm( N ),\n              Y = 3 + 0.5 * X1 + 1.5 * X2 + rnorm( N ) )\n```\n\nThe above makes an `X2` that is correlated with `X1`, and a `Y` that is a function of both.\nThe true model here is $$ Y_i = \\beta_0 + \\beta_1 X_{1i} + \\beta_2 X_{2i} + \\epsilon_{i} $$ with coefficents $\\beta = (3, 0.5, 1.5)$.\n\nWe fit two models, one with both covariates, and one with only one:\n\n```{r}\nM0 = lm( Y ~ 1 + X1 + X2 , data = dat )\nM1 = lm( Y ~ 1 + X1, data = dat )\n```\n\nOur results:\n\n```{r}\ntab_model(M0, M1, p.style = \"stars\",\n          show.ci = FALSE, show.se = TRUE)\n```\n\nNote our coefficient is completely wrong when we omit a correlated variable.\nThis is omitted variable bias, and in terms of our assumptions we are in a circumstance where the true residuals in our model are not centered around 0 for all values of `X1`, since they include the `X2` effect which is correlated with `X1`.\nWe can see this as follows:\n\n```{r, fig.height=3, fig.width=3}\ndat = mutate( dat, e = Y - 3 - 0.5 * X1 )\nggplot( dat, aes( X1, e ) ) +\n    geom_point() +\n    geom_hline( yintercept = 0 )\n```\n\nNote how our residuals (which includes `X2`) are positive for bigger `X1`, due to the correlation of `X1` and `X2`.\n\n*Conclusion:* On one hand, we have the wrong estimate for $\\beta_1$.\nOn the other, the estimate we do get is fine if we view it as the best description of the data.\nWe just need to remember that the interpretation of our coefficient includes the confounding effect of `X2` on `X1`.\n\nIn this vein:\n\nQ: You mentioned during class that we don't care too much about assumptions when looking at trends in the data.\nHowever, if we are trying to draw causal inferences, do these assumptions become more important?\n\nA: Even with the assumptions causal inference would depend on the model.\nModern causal inference has a hard time with this, so you need other strategies such as quasiexperimental design.\nHence my focus on descriptive aspects of data analysis.\n\n## Independence assumptions\n\nThe independence assumptions are key.\nWhen we do not take violations of independence into account, we can be overly confident of our estimates.\n\nGenerally with MLM we should think of these assumptions in terms of how we sampled our data.\nIf we sampled our data by sampling a collection of schools, and then individuals within those schools, then we have two levels.\nWe then need to ask two questions:\n\n(1) Were the schools sampled independently?\n\n(2) Were the students sampled independently within the schools?\n\nIf yes to both, we have met both our independence assumptions!\nWe have met them even if the students are clustered in classes within their schools.\nAs long as we did not sample using those classes (or other clusters), we are ok as our sample of students will be representative of the school they are in.\n\nOne might then ask, more generally, if there is a problem with clustering if it's not part of the sampling plan?\nE.g. if you sampled at the school level and surveyed all students, there is still natural clustering in classrooms: is that a problem?\nWhat about unobserved clustering like families, neighborhoods, etc. which are not part of sampling, but do exist naturally in populations?\n\nE.g., see this [document](https://blogs.worldbank.org/impactevaluations/when-should-you-cluster-standard-errors-new-wisdom-econometrics-oracle) which says clustered SEs are *not* necessary (in OLS) unless sampling was conducted at the cluster-level and that econometricians often overuse them.\n\nThis is indeed correct.\nThat being said, we might want to make clusters to investigate how things vary across those clusters.\n\nQ: More generally, is there a problem with clustering if it's not part of the sampling plan?\nE.g. if you sampled at the school level and surveyed all students, there is still natural clustering in classrooms: is that a problem?\nWhat about unobserved clustering like families, neighborhoods, etc. which are not part of sampling, but do exist naturally in populations?\nQ: I'll let Luke respond to how this affects the assumptions later on Piazza.\nMy intuition is that we want to cluster/add levels at these different levels if we believe the outcomes or predictors are correlated Q: Thanks.\nI remember reading this https://blogs.worldbank.org/impactevaluations/when-should-you-cluster-standard-errors-new-wisdom-econometrics-oracle a few years ago, which says clustered SEs are *not* necessary (in OLS) unless sampling was conducted at the cluster-level and that econometricians often overuse them, but I am wondering to what degree this holds in MLMs.\n\nA: This is correct.\nThat being said, we might want to make clusters to investigate how things vary across those clusters.\n\n## Number of clusters needed?\n\nOk, this isn't an assumption per se, but onwards!\n\nQ: Why should you worry if the number of group is small?\n(referencing the recap slide)\n\nA: With few clusters, estimation is hard just like having a small dataset with OLS.\nThe variance parameters in particular are difficult.\n\nQ: When you say \"at least 20\" you mean for the number of j's, right?\n\nA: Yes, number of clusters.\nMostly Harmless Econometrics readers might recall a discussion of 42 clusters (8.2.3), which contributes to this debate of the appropriate level of j-units\n\n## Testing assumptions\n\nQ: How do we test these assumptions?\n\nA: Often with plots, like with classic OLS.\nfor example we can pot a histogram of the residuals and see if they are normally distributed.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"pygments","output-file":"reg_assumptions.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","bibliography":["references.bib"],"output_dir":"docs","editor":{"markdown":{"wrap":"sentence"}},"theme":"cosmo","code-copy":true,"title":"MLM Assumptions","author":"Luke Miratrix"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","highlight-style":"pygments","output-file":"reg_assumptions.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"output_dir":"docs","editor":{"markdown":{"wrap":"sentence"}},"documentclass":"scrreprt","title":"MLM Assumptions","author":"Luke Miratrix"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}