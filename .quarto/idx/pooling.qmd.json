{"title":"Pooling","markdown":{"yaml":{"title":"Pooling","author":"Luke Miratrix","editor":{"markdown":{"wrap":"sentence"}}},"headingText":"Pooled/unpooled v.s. fixed/random effects","containsRefs":false,"markdown":"\n\n\nYou may have noticed that we use a couple of different terms interchangeably in this class when it comes to models.\nSometimes we talk about coefficients as being completely pooled/partially pooled/unpooled, and sometimes we talk about coefficients as being random or fixed.\nYikes, so confusing!\nHere's a quick document explaining what these various terms mean and what sorts of models they represent.\nWe're only going to be talking about models where the pooling applied to the intercept and slope is the same; most models look like this, and these models are easier to talk about.\nYou should be able to see how you might pool different coefficients differently, though the R code for that can be challenging.\nWe'll use the HSB data, and all of the models we'll consider will look at regressions of math achievement on SES.\n\n### Completely pooled\n\nA completely pooled model is a model where we assume that every second-level unit (school) has the same intercept and slope (slopes and intercepts are both completely pooled).\nThis doesn't really have an analog in the fixed/random effects world.\n\nA completely pooled model in this setting might look like\n\n$$\\begin{aligned}\n    mathach_i &= \\beta_0 + \\beta_1SES_i + \\varepsilon_i \\\\\n    \\varepsilon_i &\\sim Normal(0, \\sigma^2)\n\\end{aligned}$$\n\nIn a completely pooled model we're basically assuming that every school has the same intercept and slope, so we just ignore school membership; notice that we don't even include the $j$ subscript because we're ignoring schools completely.\nHow rude!\n\nWe would fit this model with\n\n`lm(mathach ~ ses)`.\n\n### Partially pooled\n\nA partially pooled model allows for the possibility that different schools might have different slopes and intercepts, but assumes that these slopes and intercepts come from a Normal distribution, which has the effect of pulling them all in towards a grand mean (or *partially pooling* them).\nThis model can also be called a model with random slopes and random intercepts, since we assume that school intercepts and residuals are random draws from a multivariate distribution with means equal to the grand means (and some possibly non-0 correlation).\nWe don't try to estimate these by themselves, only their variances and covariance.\n\nThis model can be represented as\n\n$$\\begin{aligned}\nmathach_{ij} &= \\beta_{0j[i]} + \\beta_{1j[i]}SES_i + \\varepsilon_i, \\\\\n    \\beta_{0j} &= \\gamma_{00} + u_{0j},\\\\\n    \\beta_{1j} &= \\gamma_{10} + u_{1j},\\\\\n    \\varepsilon_i &\\sim Normal(0, \\sigma^2_\\varepsilon) \\\\\n    \\begin{pmatrix}\n        u_{0j}\\\\\n        u_{1j}\\\\\n    \\end{pmatrix} &\\sim  N\n    \\begin{bmatrix}\n        \\begin{pmatrix}\n            0\\\\\n            0\n        \\end{pmatrix}\\!\\!,&\n        \\begin{pmatrix}\n            \\sigma^2_0 & \\rho\\sigma_0\\sigma_1\\\\\n            \\rho\\sigma_0\\sigma_1 & \\sigma^2_1\n        \\end{pmatrix}\n    \\end{bmatrix}\n\\end{aligned}$$\n\nWe would fit this model with\n\n`lmer(mathach ~ ses + (ses|school))`\n\n### Unpooled\n\nIn an unpooled model, we don't share *any* information across schools about the slopes and intercepts.\nInstead, we estimate each one separately in each higher-order unit.\nThis is a *fixed-effects* model, because the model treats each school-level slope and intercept as a fixed quantity in the population to be estimated directly.\nIn general parlance, to be a little more precise, a fixed-effects model is a model with unpooled intercepts and completely pooled slopes (although in theory the completely pooled model also has only fixed effects, it's just that those effects are the same in every school; this is why the language of completely pooled, partially pooled, and unpooled coefficients is a little more precise, though it's also less popular).\n\nWe could represent an unpooled model as\n\n$$\\begin{aligned}\n    mathach_{ij} &= \\beta_{0j[i]} + \\beta_{1j[i]}SES_i + \\varepsilon_i \\\\\n    \\varepsilon_i &\\sim Normal(0, \\sigma^2)\n\\end{aligned}$$\n\nWe would fit the model with\n\n`lm(mathach ~ ses*school)`\n\nalthough we might get our estimates in a more useful way by specifying an (identical) model which has no reference school, i.e.,\n\n`lm(mathach ~ 0 + ses + ses:school)`\n\nFor either of these models to fit you need to ensure that school is coded as a factor and not a number; this is *not* a concern for `lmer`.\n","srcMarkdownNoYaml":"\n\n## Pooled/unpooled v.s. fixed/random effects\n\nYou may have noticed that we use a couple of different terms interchangeably in this class when it comes to models.\nSometimes we talk about coefficients as being completely pooled/partially pooled/unpooled, and sometimes we talk about coefficients as being random or fixed.\nYikes, so confusing!\nHere's a quick document explaining what these various terms mean and what sorts of models they represent.\nWe're only going to be talking about models where the pooling applied to the intercept and slope is the same; most models look like this, and these models are easier to talk about.\nYou should be able to see how you might pool different coefficients differently, though the R code for that can be challenging.\nWe'll use the HSB data, and all of the models we'll consider will look at regressions of math achievement on SES.\n\n### Completely pooled\n\nA completely pooled model is a model where we assume that every second-level unit (school) has the same intercept and slope (slopes and intercepts are both completely pooled).\nThis doesn't really have an analog in the fixed/random effects world.\n\nA completely pooled model in this setting might look like\n\n$$\\begin{aligned}\n    mathach_i &= \\beta_0 + \\beta_1SES_i + \\varepsilon_i \\\\\n    \\varepsilon_i &\\sim Normal(0, \\sigma^2)\n\\end{aligned}$$\n\nIn a completely pooled model we're basically assuming that every school has the same intercept and slope, so we just ignore school membership; notice that we don't even include the $j$ subscript because we're ignoring schools completely.\nHow rude!\n\nWe would fit this model with\n\n`lm(mathach ~ ses)`.\n\n### Partially pooled\n\nA partially pooled model allows for the possibility that different schools might have different slopes and intercepts, but assumes that these slopes and intercepts come from a Normal distribution, which has the effect of pulling them all in towards a grand mean (or *partially pooling* them).\nThis model can also be called a model with random slopes and random intercepts, since we assume that school intercepts and residuals are random draws from a multivariate distribution with means equal to the grand means (and some possibly non-0 correlation).\nWe don't try to estimate these by themselves, only their variances and covariance.\n\nThis model can be represented as\n\n$$\\begin{aligned}\nmathach_{ij} &= \\beta_{0j[i]} + \\beta_{1j[i]}SES_i + \\varepsilon_i, \\\\\n    \\beta_{0j} &= \\gamma_{00} + u_{0j},\\\\\n    \\beta_{1j} &= \\gamma_{10} + u_{1j},\\\\\n    \\varepsilon_i &\\sim Normal(0, \\sigma^2_\\varepsilon) \\\\\n    \\begin{pmatrix}\n        u_{0j}\\\\\n        u_{1j}\\\\\n    \\end{pmatrix} &\\sim  N\n    \\begin{bmatrix}\n        \\begin{pmatrix}\n            0\\\\\n            0\n        \\end{pmatrix}\\!\\!,&\n        \\begin{pmatrix}\n            \\sigma^2_0 & \\rho\\sigma_0\\sigma_1\\\\\n            \\rho\\sigma_0\\sigma_1 & \\sigma^2_1\n        \\end{pmatrix}\n    \\end{bmatrix}\n\\end{aligned}$$\n\nWe would fit this model with\n\n`lmer(mathach ~ ses + (ses|school))`\n\n### Unpooled\n\nIn an unpooled model, we don't share *any* information across schools about the slopes and intercepts.\nInstead, we estimate each one separately in each higher-order unit.\nThis is a *fixed-effects* model, because the model treats each school-level slope and intercept as a fixed quantity in the population to be estimated directly.\nIn general parlance, to be a little more precise, a fixed-effects model is a model with unpooled intercepts and completely pooled slopes (although in theory the completely pooled model also has only fixed effects, it's just that those effects are the same in every school; this is why the language of completely pooled, partially pooled, and unpooled coefficients is a little more precise, though it's also less popular).\n\nWe could represent an unpooled model as\n\n$$\\begin{aligned}\n    mathach_{ij} &= \\beta_{0j[i]} + \\beta_{1j[i]}SES_i + \\varepsilon_i \\\\\n    \\varepsilon_i &\\sim Normal(0, \\sigma^2)\n\\end{aligned}$$\n\nWe would fit the model with\n\n`lm(mathach ~ ses*school)`\n\nalthough we might get our estimates in a more useful way by specifying an (identical) model which has no reference school, i.e.,\n\n`lm(mathach ~ 0 + ses + ses:school)`\n\nFor either of these models to fit you need to ensure that school is coded as a factor and not a number; this is *not* a concern for `lmer`.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"pygments","output-file":"pooling.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","bibliography":["references.bib"],"output_dir":"docs","editor":{"markdown":{"wrap":"sentence"}},"theme":"cosmo","code-copy":true,"title":"Pooling","author":"Luke Miratrix"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","highlight-style":"pygments","output-file":"pooling.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"output_dir":"docs","editor":{"markdown":{"wrap":"sentence"}},"documentclass":"scrreprt","title":"Pooling","author":"Luke Miratrix"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}